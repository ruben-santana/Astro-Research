
;Step 1 Load Spectra correctly and seperate the x and y-values into
;differnt arrays
function x_array, array_input
  
  x_array = array_input[*,0]; takes the all elements first row of array and puts them in a new array

  return, x_array ; returns the new array

end


function y_array, array_input
  
  y_array = array_input[*, 1] ;takes all elements of sencond row of array and puts them in a new array

  return, y_array ;returns the new array

end





; Step2: Design a way to prevent the lower-intensity noise from affecting
; your script

; Finds all maximums in graph and prints out the 3 largest
function all_peaks, array_input
 
  ; making empty arrays and getting x and y elements out of array
  intensity_peaks = []
  wavelengths = []
  x = x_array(array_input)
  y = y_array(array_input)

  ; For loop finds all local maximums
  for i=1, n_elements(y)-1 do begin
     
     if y[i] GT 1500 then begin
        intensity_peaks = [intensity_peaks, y[i]]
        wavelengths = [wavelengths, x[i]]
     endif
     i = i + 1
  
  endfor
  
  x_y_array = [[wavelengths] ,[intensity_peaks]]  


  return, x_y_array
end



;Step 3: automatically find the centroids of the 3 most notable lines.
  
  ; this half of code gets the three largest peak values

pro top3_peaks, array_input

  peaks  = all_peaks(array_input)

  w_peaks = [x_array(peaks)] ; wavelengths
  i_peaks = [y_array(peaks)] ; intensity local maximums
  
  emission_line = [] ; grouping the peak values near each other
  a = 0 ; start of each interval
  
  for i=0, n_elements(i_peak)-2 do begin

     if i_peak[i+1]-i_peak[i] gt 100 then begin
        
        ; center of mass by summing up arrays
        wavelength = (w_peaks[a : i] + i_peak[a : i]) / (total(i_peaks[a : i]) 
        
        emission_line = [[emission_line],[wavelength]] ;Saves wavelength of peak
        a = i+1

     endif

  endfor

 ; adds the final interval of the last peak
wavelength = (w_peaks[a : i] + i_peak[a : i]) / (total(i_peaks[a : i]) 
emission_line = [[emission_line],[wavelength]] ;Saves wavelength of peak

print, 'The wavelengths of the three peaks are: ', emission_line

end




;3 most notable lines



;Step 4: Load centroids of each emission line into an array and have
;your script print it out.
